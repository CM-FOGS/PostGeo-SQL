CREATE OR REPLACE FUNCTION ST_ExtractExternalRectanglesInGrid(
    geom GEOMETRY)
RETURNS TABLE (geom GEOMETRY) AS 
$BODY$ 
	WITH
	    tbla AS (SELECT (ST_Dump($1)).geom),
	    tblb AS (SELECT ST_ExteriorRing(ST_Union(geom)) geom FROM tbla)
	    SELECT (a.geom) geom FROM tbla a JOIN tblb b ON ST_Intersects(a.geom, b.geom);
$BODY$
LANGUAGE SQL

SELECT ST_ExtractExternalRectanglesInGrid(ST_Collect(geom)) geom FROM <polygon_grid_table>
